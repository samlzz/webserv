<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload / PUT - Webserv Test Suite</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Upload &amp; PUT</h1>
            <p>Upload de fichiers (multipart/form-data) et création via PUT</p>
        </header>

        <nav>
            <ul>
                <li><a href="/index.html">Accueil</a></li>
                <li><a href="/get.html">GET / HEAD</a></li>
                <li><a href="/post.html">POST</a></li>
                <li><a href="/upload.html" class="active">Upload / PUT</a></li>
                <li><a href="/delete.html">DELETE</a></li>
                <li><a href="/cgi.html">CGI</a></li>
                <li><a href="/errors.html">Erreurs</a></li>
                <li><a href="/redirect.html">Redirections</a></li>
                <li><a href="/headers.html">Headers</a></li>
                <li><a href="/autoindex.html">Autoindex</a></li>
                <li><a href="/chunked.html">Chunked</a></li>
                <li><a href="/stress.html">Stress / Timeout</a></li>
            </ul>
        </nav>

        <div class="card">
            <h2><span class="method-badge method-post">POST</span> Upload multipart</h2>

            <div id="upload-area" class="upload-area">
                <p><strong>Glissez-déposez</strong> un fichier ici</p>
                <p>ou <strong>cliquez</strong> pour sélectionner</p>
                <input type="file" id="file-input" style="display: none;">
            </div>

            <div id="upload-progress" class="progress-bar" style="display: none;">
                <div class="progress" style="width: 0%;"></div>
            </div>

            <h3>Upload via formulaire HTML natif</h3>
            <form action="/uploads/" method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="manual-file">Fichier :</label>
                    <input type="file" id="manual-file" name="file" required>
                </div>
                <button type="submit" class="btn btn-success">Upload (formulaire)</button>
            </form>
        </div>

        <!-- PUT -->
        <div class="card">
            <h2><span class="method-badge method-post">PUT</span> Créer / remplacer un fichier</h2>
            <p>PUT envoie un body brut pour créer ou remplacer un fichier à l'URL indiquée.</p>

            <div class="form-group">
                <label for="put-url">URL de destination :</label>
                <input type="text" id="put-url" value="/uploads/put_test.txt" placeholder="/uploads/mon_fichier.txt">
            </div>
            <div class="form-group">
                <label for="put-ct">Content-Type :</label>
                <select id="put-ct">
                    <option value="text/plain">text/plain</option>
                    <option value="application/octet-stream">application/octet-stream</option>
                    <option value="application/json">application/json</option>
                </select>
            </div>
            <div class="form-group">
                <label for="put-content">Contenu :</label>
                <textarea id="put-content" rows="5">Hello from PUT request!</textarea>
            </div>
            <button class="btn btn-success" onclick="testPut()">Envoyer PUT</button>
        </div>

        <!-- Fichiers uploadés -->
        <div class="card">
            <h2>Fichiers uploadés</h2>
            <ul id="uploaded-files-list" class="file-list">
                <li>Chargement...</li>
            </ul>
            <button class="btn btn-primary" onclick="listUploadedFiles()">Actualiser</button>
            <a href="/uploads/" class="btn btn-success">Voir autoindex</a>
        </div>

        <div class="card">
            <h2>Réponse du serveur</h2>
            <div id="upload-response" class="response-box">
                <span class="status">En attente d'un upload...</span>
            </div>
        </div>

        <div class="card">
            <h2>Documentation</h2>
            <h3>POST multipart/form-data :</h3>
            <pre>POST /uploads/ HTTP/1.1
Content-Type: multipart/form-data; boundary=----Boundary

------Boundary
Content-Disposition: form-data; name="file"; filename="test.txt"
Content-Type: text/plain

[contenu]
------Boundary--</pre>

            <h3>PUT text/plain :</h3>
            <pre>PUT /uploads/test.txt HTTP/1.1
Content-Type: text/plain
Content-Length: 13

Hello World!</pre>

            <h3>Codes de réponse :</h3>
            <table>
                <tr><th>Code</th><th>Signification</th></tr>
                <tr><td><span class="badge badge-success">200</span></td><td>Fichier remplacé</td></tr>
                <tr><td><span class="badge badge-success">201</span></td><td>Fichier créé</td></tr>
                <tr><td><span class="badge badge-danger">400</span></td><td>Requête invalide</td></tr>
                <tr><td><span class="badge badge-danger">403</span></td><td>Upload non autorisé</td></tr>
                <tr><td><span class="badge badge-danger">413</span></td><td>Fichier trop volumineux</td></tr>
            </table>
        </div>

        <footer><p>Webserv Test Suite — 42 Project</p></footer>
    </div>
    <script src="/js/app.js"></script>
</body>
</html>
